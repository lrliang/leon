## 简介
“移动方法”（Move Method）是一种重构技术，它主要用于把一个类中的方法移动到更合适的类当中。这么做能让类的职责划分更加清晰，让代码结构更符合高内聚、低耦合的设计原则。下面是进行“移动方法”重构的详细步骤：

## 移动方法（Move Method）的详细步骤
1. 确定待移动的方法
   - 分析职责：查看方法的实现逻辑，确定它实际执行的功能与所在类的主要职责是否契合，找出那些看起来“格格不入”的方法。
   - 依赖关系梳理：检查方法所依赖的变量、字段和其他方法，看这些依赖元素在哪个类中更为集中，以此辅助判断方法的归属。
2. 选择目标类
   - 目标类定位：基于上述分析，找到一个职责与该方法更匹配的类。这个类通常已经拥有部分与该方法相关的逻辑、数据成员，或者对方法执行所需的数据有更便捷的访问权限。
3. 移动方法
   - 复制代码：把要移动的方法的代码完整复制到目标类中。
   - 调整访问修饰符：根据目标类的封装要求，适当调整方法的访问修饰符，确保其既能满足功能需求，又遵循类的访问控制规则。
   - 迁移依赖：把方法所依赖的本地变量、字段，如果不能直接访问，需要在目标类中以合适的方式重新声明、初始化；对于其他相关方法，确保在目标类中有对应的调用途径。
4. 更新原类
   - 删除原方法：在原来的类中删除被移动走的方法，避免代码冗余。
   - 修正调用点：找到原类以及其他类中对该方法的所有调用点，将调用指向新的目标类中的方法。这可能涉及修改导入语句、类名限定等操作。
5. 测试
   - 编译代码：首先确保代码能够顺利编译，不存在因类、方法移动造成的语法错误。
   - 运行测试：执行所有相关的单元测试，确认这次移动操作没有引入新的缺陷，功能依然完好无损。
   - 手动测试：倘若自动化测试覆盖不足，补充必要的手动测试，尤其是针对涉及该方法的业务流程进行完整测试。
6. 代码审查
   - 同行评审：邀请同事或团队中的其他开发者对更改的代码进行评审，从不同视角检查代码质量、设计合理性。
   - 文档更新：若项目有对应的设计文档、API 文档，及时更新涉及该方法移动的相关说明，让后续维护者清晰知晓变动情况。

## 示例
假设有两个类，`Customer` 和 `Order`，在 `Customer` 类中有一个方法用于计算某个客户的订单总额，代码如下：
```java
public class Customer {
    private List<Order> orders;

    public double calculateTotalOrderAmount() {
        double total = 0;
        for (Order order : orders) {
            total += order.getTotalPrice();
        }
        return total;
    }
}
```

## 步骤如下：
1. 确定待移动的方法：
   - `calculateTotalOrderAmount` 方法虽然在 `Customer` 类中，但它的核心操作是遍历订单来累加总价，和 `Order` 类的关联度更高，所以考虑移动它。
2. 选择目标类：
   - 目标类为 `Order`，因为该方法主要围绕 `Order` 的价格计算展开。
3. 移动方法：
   - 将 `calculateTotalOrderAmount` 方法复制到 `Order` 类中：
   ```java
   public class Order {
       // 假设Order类已有getTotalPrice方法
       public double calculateTotalOrderAmount(List<Order> orders) {
           double total = 0;
           for (Order order : orders) {
               total += order.getTotalPrice();
           }
           return total;
       }
   }
   ```
   调整访问修饰符（假设调整为 public），迁移依赖时，由于原方法依赖 Customer 类里的 orders 列表，在新的 Order 类场景下，把 orders 作为参数传入，保证方法能正常运行。
4. 更新原类：
   - 在 Customer 类中删除 calculateTotalOrderAmount 方法，避免出现重复代码。
   - 修正所有调用该方法的地方，假设在另一个类 ShoppingCart 中有代码 customer.calculateTotalOrderAmount() ，就需要改成 Order.calculateTotalOrderAmount(customer.getOrders())，保证程序逻辑连贯。
5. 测试：
   - 编译代码，查看是否有语法报错，诸如找不到方法定义这类因移动方法产生的编译问题。
   - 运行单元测试套件，覆盖各种涉及订单总额计算的测试用例，确保移动方法后业务逻辑没有偏差，数据计算依旧准确。
   - 手动测试一些关键业务流程，例如模拟用户下单结算流程，确认整个系统功能不受此次重构影响。
6. 代码审查：
   - 邀请同事参与同行评审，他们可能从不同的编码习惯、设计思路出发，检查是否存在遗漏的更新点，例如是否所有

